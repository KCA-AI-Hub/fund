# 민원처리 챗봇 - 쉽게 이해하기

> 컴퓨터 전공이 아니어도 이해할 수 있는 설명서

---

## 이 시스템은 뭐하는 건가요?

**한 줄 요약**: 직원이 민원 질문을 입력하면, AI가 자동으로 답변 초안을 만들어주는 도우미입니다.

### 예시 상황

```
직원: "사업비 교부는 어떻게 받나요?"

챗봇이 하는 일:
1. 비슷한 질문이 있었는지 찾아봄 (FAQ 검색)
2. 관련 법령/규정을 찾아봄 (법령 검색)
3. 찾은 자료를 바탕으로 답변 초안 작성

결과: 답변 초안 + 참고한 법령 목록 제공
```

---

## 워크플로우 (일하는 순서)

**사용자가 질문을 입력하면 다음 순서로 작동합니다:**

```
질문 입력 → FAQ에서 비슷한 질문 찾기 → 관련 법령 검색 → AI가 답변 작성 → 화면에 표시
```

조금 더 자세히 보면:

```
┌─────────────────────────────────────────────┐
│  1. 사용자가 질문 입력                        │
│     "사업비 교부는 어떻게 받나요?"            │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│  2. FAQ 검색 (Dify)                          │
│     - 102개 FAQ 중에서 비슷한 질문 찾기       │
│     - "사업비", "교부" 같은 의미 파악          │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│  3. 법령 검색 (SQLite)                       │
│     - 1,063개 법령 중에서 관련 조항 찾기      │
│     - "기금운영지침 제10조" 등                │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│  4. AI 답변 생성 (GPT)                       │
│     - 찾은 FAQ + 법령을 참고해서 답변 작성    │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│  5. 화면에 표시                              │
│     - 왼쪽: 대화 내용                        │
│     - 오른쪽: 답변 추천 + 관련 법령           │
└─────────────────────────────────────────────┘
```

---

## 화면 구성

```
┌──────────┬────────────────────┬─────────────────┐
│          │                    │                 │
│ 사이드바  │    채팅 영역        │  오른쪽 패널     │
│          │                    │                 │
│ [새채팅]  │ 사용자: 질문...     │ 💡 답변 추천    │
│          │                    │                 │
│ 이전채팅1 │ 챗봇: 답변...       │ (수정/복사 가능) │
│ 이전채팅2 │                    │                 │
│          │ [답변생성] 버튼     │ ⚖️ 관련 법령    │
│          │                    │                 │
│          │ ─────────────      │ [법령1]         │
│          │ [질문 입력창]       │ [법령2]         │
│          │ [예시 버튼들]       │ (수정/복사 가능) │
│          │                    │                 │
└──────────┴────────────────────┴─────────────────┘
```

### 주요 기능

| 영역 | 기능 |
|------|------|
| **사이드바** | 새 채팅 시작, 이전 채팅 내역 보기 |
| **채팅 영역** | 질문 입력, 대화 내용 확인, 예시 버튼 클릭 |
| **오른쪽 패널** | 답변 추천 보기/수정, 관련 법령 보기/수정 |

---

## 데이터는 어디에 저장되나요?

### 두 가지 저장소를 사용합니다

```
FAQ (자주 묻는 질문) 102개
    ↓
    Dify 서버에 저장
    - 의미를 이해해서 검색 (예: "받는 방법" = "교부 절차")
    - 외부 서버 (인터넷 연결 필요)

법령/규정 1,063개
    ↓
    SQLite 파일에 저장 (chatbot.db)
    - 정확한 키워드로 검색 (예: "제10조" 검색하면 제10조만 찾음)
    - 내 컴퓨터에 저장 (인터넷 없어도 됨)
```

### 왜 두 곳에 나눠서 저장하나요?

| 데이터 | 저장소 | 이유 |
|--------|--------|------|
| FAQ | Dify | 사람들이 다양하게 질문하니까 의미로 찾아야 함 |
| 법령 | SQLite | "제10조"라고 하면 정확히 제10조를 찾아야 함 |

---

## 파일 구조 (폴더 안에 뭐가 있나요?)

```
test_dify/
│
├── 📁 data/                    ← 데이터 파일들
│   ├── faq_topic.xlsx         (FAQ 102개 - 원본)
│   ├── law.xlsx               (법령 1,063개 - 원본)
│   └── chatbot.db             (법령 데이터베이스)
│
├── 📁 templates/               ← 화면 디자인
│   ├── base.html              (기본 틀)
│   └── index.html             (메인 화면)
│
├── 📁 static/                  ← 화면 꾸미기
│   ├── css/styles.css         (색상, 레이아웃)
│   └── js/app.js              (버튼 동작, 채팅 기능)
│
├── 📄 app.py                   ← 서버 프로그램 (핵심!)
├── 📄 database.py              ← 법령 검색 기능
│
└── 📁 improve/                 ← 설명 문서
    ├── strategy.md            (개발자용 상세 설명)
    └── strategy_easy.md       (이 문서)
```

---

## 실행하는 방법

### 1단계: 서버 켜기

```bash
uv run app.py
```

### 2단계: 브라우저에서 접속

```
http://localhost:5000
```

### 3단계: 사용하기

1. 질문을 직접 입력하거나
2. "자주 들어오는 민원 예시" 버튼 클릭
3. [답변생성] 버튼 클릭하면 오른쪽에 답변 표시

---

## 자주 묻는 질문

### Q1. 인터넷 없으면 안 되나요?

**일부만 됩니다.**
- FAQ 검색: 인터넷 필요 (Dify 서버 사용)
- 법령 검색: 인터넷 없어도 됨 (내 컴퓨터에 저장)
- AI 답변: 인터넷 필요 (OpenAI 사용)

### Q2. AI가 틀린 답변을 하면요?

**수정할 수 있습니다.**
- 오른쪽 패널의 [수정] 버튼 클릭
- 내용 직접 수정
- [복사] 버튼으로 복사해서 사용

### Q3. 법령이 업데이트되면요?

**관리자가 업데이트해야 합니다.**
1. `data/law.xlsx` 파일 수정
2. 변환 스크립트 실행: `uv run python convert_law_to_db_sheets.py`
3. 서버 재시작

### Q4. 예시 버튼을 바꾸고 싶어요

**HTML 파일을 수정합니다.**
- 파일 위치: `templates/index.html`
- 30~35번째 줄의 버튼 텍스트와 질문 내용 수정

```html
<button class="example-btn" data-example="여기에 자동입력될 질문">버튼에 보일 텍스트</button>
```

---

## 용어 설명

| 용어 | 쉬운 설명 |
|------|----------|
| **Flask** | 웹사이트를 만드는 도구 (서버 프로그램) |
| **SQLite** | 엑셀처럼 데이터를 저장하는 파일 (작은 데이터베이스) |
| **Dify** | AI 검색 서비스 (의미를 이해해서 찾아줌) |
| **GPT** | ChatGPT를 만든 회사(OpenAI)의 AI (답변 작성) |
| **API** | 프로그램끼리 대화하는 방법 |
| **RAG** | "검색해서 답변하기" (Retrieval-Augmented Generation) |

---

## 문제가 생겼을 때

### 서버가 안 켜져요

```bash
# 패키지 설치 확인
uv sync

# 다시 실행
uv run app.py
```

### 화면이 안 나와요

1. 터미널에 에러 메시지 확인
2. `http://localhost:5000` 주소 정확히 입력했는지 확인
3. 다른 프로그램이 5000번 포트 사용 중인지 확인

### AI 답변이 안 나와요

1. `.env` 파일에 API 키가 있는지 확인
2. 인터넷 연결 확인
3. Dify 서버 상태 확인

---

## 3줄 요약

1. **직원이 질문하면** → AI가 FAQ와 법령을 찾아서 답변 초안을 만들어줍니다
2. **두 가지 검색** → FAQ는 의미로 찾고(Dify), 법령은 정확한 키워드로 찾습니다(SQLite)
3. **수정 가능** → AI가 만든 답변은 직원이 확인하고 수정할 수 있습니다

---

**작성일**: 2025-12-16
**버전**: 2.1
